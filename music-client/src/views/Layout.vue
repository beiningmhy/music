<template>
    <div>
        <el-container>
            <el-aside width="200px">
                <div style="height: 60px; color: white; display: flex; align-items: center; justify-content: center"
                    @click="$route.path == '/' ? '' : $router.push('/'), songListRight = -350">
                    <!-- <img src="@/assets/images/logo1.png" alt="" style="width: 40px; height: 40px"> -->
                    <!-- <svg t="1730986111036" class="icon" viewBox="0 0 2299 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="1868" width="50" height="50">
                        <path
                            d="M1775.840814 322.588002c6.0164 1.002733 53.144869-9.525967 55.150336-6.016401 3.0082 4.5123 24.065601 155.92504 18.550567 156.927774s-44.621635 10.027334-44.621635 10.027334c-3.0082-20.556034-28.577901-147.903173-29.079268-160.938707m75.205003-14.539634l20.556034 162.944174c10.5287-0.501367 53.144869-3.509567 57.155803-4.010934-6.0164-61.668103-16.545101-158.933241-16.545101-158.93324-20.054668-4.010934-41.112069-4.010934-61.166736 0m-40.610702 226.116376s92.752838-23.564234 126.344406-12.0328c17.046467 61.668103 48.131202 407.611118 51.139402 421.649386-21.057401 2.506833-90.246004 8.523234-95.761037 10.027333-4.5123-26.071068-81.72277-403.098818-81.722771-419.643919m343.436183-207.565809c5.515034 1.5041 54.648969-5.013667 55.150335-1.5041 1.002733 12.032801 6.0164 157.42914 0.501367 157.930507s-44.621635 4.010934-44.621635 4.010934c-1.002733-20.054668-12.032801-146.90044-11.030067-160.437341m75.70637-4.010933l4.010933 160.938707c10.5287 0 52.643502 2.506833 57.155803 2.005467-1.002733-61.668103 0-158.933241 0-158.933241-20.054668-3.509567-40.610702-5.013667-61.166736-4.010933m-64.676303 216.089043s94.758304-12.534167 126.845772 2.506833c7.019134 72.196803 6.0164 408.613852 7.019134 422.652119-21.558768 0-90.246004 1.002733-95.761038 2.005467-1.002733-26.071068-39.607968-410.619319-38.103868-427.164419m-220.099977-413.627519c54.648969 278.759879 96.262404 755.058234 97.766504 785.641602 0 0 43.117535 1.002733 91.750105 4.010934C2105.740095 614.383415 2070.644427 134.575493 2071.145794 119.033126c-12.032801-13.536901-126.344406 6.0164-126.344406 6.0164m-120.328005 659.297196c-10.5287-78.213204-290.291313-166.955108-447.720454-138.377206 0 0-19.553301-172.470141-27.073801-339.425248-6.517767-143.390873-1.002733-282.770813 0.501366-305.833681-10.5287-7.5205-123.837572 46.627102-185.004308 69.188603 0 0 73.199537 309.844614 126.344406 952.59671 0 0 84.730971 9.0246 230.12731-19.051934s317.365114-115.815705 302.825481-219.097244m-341.932083 140.88404l-24.566967-176.982441c6.0164-3.0082 156.927774 53.144869 172.971507 63.172203-2.506833 11.030067-148.40454 113.810238-148.40454 113.810238M610.664628 322.588002c6.0164 1.002733 53.144869-9.525967 55.150335-6.016401 3.0082 4.5123 24.065601 155.92504 18.550568 156.927774s-44.621635 10.027334-44.621635 10.027334c-3.0082-20.556034-28.577901-147.903173-29.079268-160.938707m75.205003-14.539634l20.556034 162.944174c10.5287-0.501367 53.144869-3.509567 57.155803-4.010934-6.517767-61.668103-16.545101-158.933241-16.545101-158.93324-20.054668-4.010934-41.112069-4.010934-61.166736 0m-40.610702 226.116376s92.752838-23.564234 126.344406-12.0328c17.046467 61.668103 48.131202 407.611118 51.139402 421.649386-21.057401 2.506833-90.246004 8.523234-95.761037 10.027333-4.5123-26.071068-81.72277-403.098818-81.722771-419.643919m343.436182-207.565809c5.515034 1.5041 54.648969-5.013667 55.150336-1.5041 1.002733 12.032801 6.0164 157.42914 0.501367 157.930507s-44.621635 4.010934-44.621635 4.010934c-1.002733-20.054668-11.531434-146.90044-11.030068-160.437341m75.706371-4.010933l4.010933 160.938707c10.5287 0 52.643502 2.506833 57.155803 2.005467-1.002733-61.668103 0-158.933241 0-158.933241-20.054668-3.509567-40.610702-4.5123-61.166736-4.010933m-64.676303 216.089043s94.758304-12.534167 126.845772 2.506833c7.019134 72.196803 6.0164 408.613852 7.019134 422.652119-21.558768 0-90.246004 1.002733-95.761038 2.005467-0.501367-26.071068-39.607968-410.619319-38.103868-427.164419m-220.099977-413.627519c54.648969 278.759879 96.262404 755.058234 97.766504 785.641602 0 0 43.117535 1.002733 91.750105 4.010934-28.577901-300.318647-63.67357-780.126569-63.172203-796.170303-12.032801-13.035534-126.344406 6.517767-126.344406 6.517767m-120.328005 659.297196c-10.5287-78.213204-290.291313-166.955108-447.720454-138.377206 0 0-19.553301-172.470141-27.073801-339.425248-6.517767-143.390873-1.002733-282.770813 0.501366-305.833681C174.475608-6.308547 61.166736 47.337689 0 69.89919c0 0 73.199537 309.844614 126.344406 952.59671 0 0 84.730971 9.0246 230.12731-19.051934s317.365114-115.815705 302.825481-219.097244m-341.932083 140.88404l-24.566967-176.982441c6.0164-3.0082 156.927774 53.144869 172.971507 63.172203-2.506833 11.030067-148.40454 113.810238-148.40454 113.810238"
                            p-id="1869" data-spm-anchor-id="a313x.collections_detail.0.i0.78093a81HkR4tf"
                            class="selected"></path>
                    </svg> -->
                    <span class="logo-title" style="color: black;">真谛好music</span>
                </div>
                <div @click="songListRight = -350">
                    <!-- 用户头像部分 -->
                    <div>
                        <div style="height: 80px;width: 80px;margin:0 auto;margin-top: 20px;">
                            <div v-if="user != '' && user.avatar != null" @click="clickTag('/space')">
                                <el-image style="width: 80px; height: 80px; border-radius: 10%;"
                                    :src="'http://localhost:8080/api/files/' + user.avatar">
                                </el-image>

                            </div>

                            <!-- <el-image v-else style="width: 100px; height: 100px; border-radius: 10%;margin-top: 10px;"
                            src="../assets/images/logo1.png"
                            :preview-src-list="['http://localhost:8080/api/files/' + item.userAvatar]">
                        </el-image> -->
                            <img v-else style="width: 100%; height: 100%; border-radius: 10%;"
                                src="@/assets/images/logo1.png" alt="">
                        </div>
                        <div>
                            <div v-if="user != ''" style="margin-top: 10px;">{{ user.username }}</div>
                            <div v-else style="margin-top: 10px;" @click="login()">点击登录</div>
                        </div>
                    </div>
                    <!-- 菜单部分 -->
                    <div style="display: flex;flex-direction: column;width: 80%;margin:  0 auto;margin-top: 20px;">
                        <div style="height: 40px;line-height: 40px;display: flex;margin-top: 5px;" class="menu-item"
                            @click="clickTag('/')">
                            <div style="height: 40px;margin-top: 5px;">
                                <svg t="1730735590148" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="3624" width="30" height="30">
                                    <path
                                        d="M765.5168 538.88a31.488 31.488 0 0 0-31.5136 31.5136v211.072l0.0768 0.8448c0.0768 1.2032 0.256 2.3552 0.5632 3.584a14.2592 14.2592 0 0 1-0.512 5.0944l-0.256 0.0768a29.952 29.952 0 0 1-7.3728 0.768l-134.0416-0.0256-0.8448-142.08c2.176-17.9968-1.024-38.9632-14.4896-55.168-10.0864-12.1088-25.1904-19.8144-45.2864-19.8144h-54.7072c-20.0704 0-35.2 7.68-45.2864 19.8144l-3.1488 4.0448c-10.8032 15.2064-13.2864 34.0224-11.2896 51.8656l-0.896 140.9024h-134.4768c-4.864 0-7.9616-0.768-8.0384-0.8192 0.2048 0.1792-0.256-3.2256 0.0256-5.3248a14.2336 14.2336 0 0 0 0.4608-3.2l0.0512-2.2016v-208.9984a31.488 31.488 0 0 0-31.5136-31.488 31.488 31.488 0 0 0-31.5136 31.488V773.12c-2.6112 16.896 0.6912 37.248 14.0288 53.4016 11.8272 14.464 30.208 23.3984 56.064 23.3984h165.4784c15.2832 0 31.5136-12.2368 31.5136-22.528l0.896-176.1024-0.0512-4.6336a14.72 14.72 0 0 0-0.7168-4.736l0.2048-4.1472h48.6656c0.2048 1.9456 0.2816 4.0192 0.128 5.5296l-0.2048 0.512c-0.256 0.896-0.256 2.8928-0.256 13.1328l0.8704 170.4704c0 10.2656 16.256 22.528 31.5136 22.528h165.504c25.5488 0 43.6736-8.96 55.9872-23.3472 13.4144-16.2304 16.7168-36.5824 14.0288-54.4256l1.8688-201.728a31.488 31.488 0 0 0-31.5136-31.5648z"
                                        fill="#2c2c2c" p-id="3625"></path>
                                    <path
                                        d="M510.4896 171.5712c-31.9488-0.896-62.336 12.5952-89.856 39.808l-18.7904 19.6352L129.5104 519.2192c-11.9296 12.5184-11.4176 32.6144 0.896 44.928 4.8384 4.864 11.2896 7.7056 18.432 8.448l4.48 0.1536c7.2192 0 14.1824-2.7904 19.712-7.68l2.4832-2.4576 285.184-302.208c16.4352-17.28 32.3328-25.7536 46.7456-25.344 9.2672 0.1536 18.2528 3.7888 26.7008 9.8048 2.9184 2.0736 5.5552 4.3008 7.936 6.6048l1.92 1.8944 2.6112 2.688 285.5168 306.5856c6.4 6.4 14.7456 10.112 23.0912 10.112 8.1408 0 15.9744-2.9952 21.5552-8.6016 12.7232-12.16 13.7472-31.8208 1.9968-44.7232L593.9456 213.0688a134.8352 134.8352 0 0 0-26.368-22.4c-15.2832-10.0352-32.0256-16.64-50.1504-18.5856l-6.912-0.512z"
                                        fill="#2c2c2c" p-id="3626"></path>
                                </svg>
                            </div>
                            <div style="margin-left: 10px;">
                                <span>首页</span>
                            </div>
                        </div>
                        <div style="height: 40px;line-height: 40px;display: flex;margin-top: 5px;" class="menu-item"
                            @click="clickTag('/singer')">
                            <div style="height: 40px;margin-top: 5px;">
                                <svg t="1730736206940" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="5578" width="30" height="30">
                                    <path
                                        d="M526.496 749.888l88.544-77.408c9.888-8.672 15.68-21.088 16.672-35.872 1.888-27.52-13.088-62.336-39.968-93.056-41.216-47.104-96.576-64.928-124.64-40.32l-88.576 77.408c-9.408 8.192-23.616 27.488-13.312 64.672 0.512 1.792 1.344 3.648 1.92 5.472l-83.808 95.552c-8.48 9.664-8.48 24.064-0.032 33.728l1.28 1.472-4.128 3.52C269.76 794.24 268.48 810.4 277.696 821.12c5.088 5.92 12.224 8.96 19.456 8.96 5.888 0 11.808-2.016 16.64-6.112l4.672-4c5.024 5.312 11.744 8.256 18.624 8.256 4.928 0 9.888-1.408 14.208-4.32l58.432-39.168 1.728 146.496c0 14.144 11.488 25.6 25.6 25.6 14.144 0 25.6-11.456 25.6-25.6l-1.728-177.184c11.136 4.736 22.08 7.68 32.096 7.68C506.016 761.728 517.568 757.632 526.496 749.888zM500.544 542.528c8.64 0 30.528 9.408 52.64 34.656 24.672 28.192 29.312 52.576 28.16 56.672l-23.072 20.288-80.384-91.936L500.544 542.528zM341.504 768.832l-4.864-5.6 56.576-64.512c2.784 3.648 5.504 7.328 8.608 10.848 3.52 4.032 7.168 7.872 10.912 11.52L341.504 768.832zM440.384 675.872c-24.704-28.192-29.312-52.576-28.16-56.672l26.944-23.392 80.608 92.16-25.536 22.464c0 0-0.384 0.096-1.216 0.096C484.384 710.528 462.432 701.152 440.384 675.872z"
                                        p-id="5579" fill="#2c2c2c"></path>
                                    <path
                                        d="M888 837.088c-1.76-15.136-3.296-42.176-4.8-68.288-1.664-29.344-3.392-59.68-5.728-77.664-5.088-39.616-12.512-86.24-29.184-132-10.848-29.824-31.648-46.528-48.512-57.728-21.184-14.144-57.952-25.568-68.992-28.8-3.712-1.088-25.536-7.456-30.88-9.44-23.808-9.056-46.304-17.6-58.784-34.656-9.408-12.832-14.4-36.032 30.784-102.528 13.152-19.36 12.096-40.608 11.296-57.696l-0.32-7.232c-0.192-9.952-5.632-17.984-6.496-19.2-0.512-0.736-1.024-1.408-1.6-2.144l-0.16-11.168c-0.16-16.096-0.352-32.768-2.592-49.856-8.992-68.8-50.944-114.144-118.208-127.648-31.2-6.272-62.208-5.6-92 2.048-60.032 15.328-97.472 54.88-108.224 114.4-1.728 9.44-2.464 18.976-3.136 28.48-0.48 6.432-0.928 12.832-1.856 19.168s-0.8 12.544-0.512 18.816c0.352 7.712 0.352 10.592-1.632 14.112-13.6 23.68-10.24 58.4 7.968 82.528 5.248 6.976 8.8 15.136 12.928 24.576l3.04 6.88c4.096 9.056 8.8 17.92 13.888 26.496 7.616 12.736 4.608 34.592-6.08 44.064-19.168 17.088-43.328 28.736-78.24 37.76-22.336 5.792-42.592 14.752-63.776 24.128-32.64 14.432-53.984 39.616-65.248 77.024-20.096 66.976-27.872 171.232-33.536 247.36l-1.696 22.4c-1.28 16.704 6.016 29.696 21.696 38.592 26.24 14.912 54.112 27.232 82.912 36.64 42.88 14.016 89.184 24.352 137.28 31.232l0-52.16c-42.496-6.368-83.584-15.36-121.376-27.712-23.616-7.712-46.528-17.664-68.896-29.952l1.248-15.328c5.504-73.792 12.992-174.816 31.52-236.448 6.944-23.136 17.952-36.544 38.528-45.632 18.496-8.192 36-15.936 54.24-20.672 42.624-11.008 74.208-26.592 99.456-49.056 29.088-25.856 36.32-74.528 16.064-108.512-4.096-6.912-7.904-14.08-11.232-21.376l-2.784-6.304c-4.736-10.848-10.112-23.104-18.944-34.88-6.688-8.832-7.136-21.632-4.512-26.208 9.568-16.64 8.896-31.904 8.416-41.984-0.128-3.008-0.448-5.984 0.032-9.056 1.088-7.552 1.632-15.2 2.208-22.88 0.544-7.68 1.056-15.392 2.432-23.04 7.2-39.968 29.632-63.456 70.528-73.92 22.304-5.696 45.44-6.176 69.248-1.44 45.984 9.248 71.36 36.768 77.536 84.128 1.824 14.048 1.984 28.448 2.144 43.712l0.192 14.688c0.256 12.064 4.736 19.808 8.32 24.512l0.096 2.496c0.544 10.944 1.024 21.28-2.496 26.464-35.264 51.872-66.368 111.616-29.728 161.536 21.44 29.248 53.568 41.472 82.528 52.48 4.96 1.888 29.792 9.248 34.272 10.56 19.136 5.6 43.488 14.656 54.816 22.208 16 10.624 24.032 19.776 28.704 32.608 14.944 41.056 21.824 84.224 26.56 121.024 2.048 16.16 3.744 45.568 5.344 74.016 1.44 25.248 2.816 49.248 4.544 66.272-45.152 24.448-96.288 41.824-156.096 53.12-59.968 11.328-123.936 15.808-187.456 14.368l0 51.36c6.592 0.128 13.088 0.736 19.712 0.736 60.8 0 120.416-5.44 177.248-16.128 67.008-12.64 124.416-32.544 175.424-60.832C886.976 868.576 889.6 850.304 888 837.088z"
                                        p-id="5580" fill="#2c2c2c"></path>
                                </svg>
                            </div>
                            <div style="margin-left: 10px;">
                                <span>歌手</span>
                            </div>
                        </div>
                        <div style="height: 40px;line-height: 40px;display: flex;margin-top: 5px;" class="menu-item"
                            @click="clickTag('/songList')">
                            <div style="height: 40px;margin-top: 5px;">
                                <svg t="1730736249960" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="6634" width="30" height="30">
                                    <path
                                        d="M964.608 234.496c-46.08-52.565333-104.789333-93.696-169.642667-118.784a34.030933 34.030933 0 0 0-46.421333 31.744v420.352a178.005333 178.005333 0 0 0-110.933333-38.741333c-98.816 0-179.2 80.384-179.2 179.2S538.794667 887.466667 637.610667 887.466667s179.2-80.384 179.2-179.2c0-1.877333-0.170667-3.754667-0.341334-5.632 0-1.024 0.341333-1.877333 0.341334-2.901334V201.216c36.181333 20.309333 69.12 46.933333 96.597333 78.165333 12.458667 14.165333 34.133333 15.530667 48.128 3.072 14.165333-12.288 15.530667-33.792 3.072-47.957333zM637.610667 819.2c-61.098667 0-110.933333-49.834667-110.933334-110.933333s49.834667-110.933333 110.933334-110.933334 110.933333 49.834667 110.933333 110.933334-49.834667 110.933333-110.933333 110.933333zM185.344 307.2h392.533333c18.773333 0 34.133333-15.36 34.133334-34.133333s-15.36-34.133333-34.133334-34.133334h-392.533333a34.133333 34.133333 0 1 0 0 68.266667zM424.277333 460.8h-238.933333c-18.773333 0-34.133333 15.36-34.133333 34.133333s15.36 34.133333 34.133333 34.133334h238.933333c18.773333 0 34.133333-15.36 34.133334-34.133334s-15.36-34.133333-34.133334-34.133333zM321.877333 682.666667h-136.533333c-18.773333 0-34.133333 15.36-34.133333 34.133333s15.36 34.133333 34.133333 34.133333h136.533333c18.773333 0 34.133333-15.36 34.133334-34.133333s-15.36-34.133333-34.133334-34.133333z"
                                        fill="#2c2c2c" p-id="6635"></path>
                                </svg>
                            </div>
                            <div style="margin-left: 10px;">
                                <span>歌单</span>
                            </div>
                        </div>
                        <div v-if="user !== ''">
                            <div style="height: 40px;line-height: 40px;display: flex;margin-top: 5px;" class="menu-item"
                                @click="clickTag('/collect')">
                                <div style="height: 40px;margin-top: 5px;">
                                    <svg t="1731299241051" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                        xmlns="http://www.w3.org/2000/svg" p-id="5668" width="30" height="30">
                                        <path
                                            d="M335.008 916.629333c-35.914667 22.314667-82.88 10.773333-104.693333-25.557333a77.333333 77.333333 0 0 1-8.96-57.429333l46.485333-198.24a13.141333 13.141333 0 0 0-4.021333-12.864l-152.16-132.586667c-31.605333-27.52-35.253333-75.648-8.234667-107.733333a75.68 75.68 0 0 1 51.733333-26.752L354.848 339.2c4.352-0.362667 8.245333-3.232 10.026667-7.594667l76.938666-188.170666c16.032-39.2 60.618667-57.92 99.52-41.461334a76.309333 76.309333 0 0 1 40.832 41.461334l76.938667 188.16c1.781333 4.373333 5.674667 7.253333 10.026667 7.605333l199.712 16.277333c41.877333 3.413333 72.885333 40.458667 69.568 82.517334a76.938667 76.938667 0 0 1-26.08 51.978666l-152.16 132.586667c-3.541333 3.082667-5.141333 8.074667-4.021334 12.853333l46.485334 198.24c9.621333 41.013333-15.36 82.336-56.138667 92.224a75.285333 75.285333 0 0 1-57.525333-9.237333l-170.976-106.24a11.296 11.296 0 0 0-12.010667 0l-170.986667 106.24zM551.786667 756.032l170.976 106.24c2.624 1.621333 5.717333 2.122667 8.650666 1.408 6.410667-1.557333 10.56-8.426667 8.928-15.424l-46.485333-198.24a77.141333 77.141333 0 0 1 24.277333-75.733333L870.293333 441.706667c2.485333-2.165333 4.053333-5.312 4.330667-8.746667 0.565333-7.136-4.490667-13.173333-10.976-13.696l-199.712-16.288a75.989333 75.989333 0 0 1-64.064-47.168l-76.938667-188.16a12.309333 12.309333 0 0 0-6.538666-6.741333c-5.898667-2.496-12.725333 0.373333-15.328 6.741333l-76.949334 188.16a75.989333 75.989333 0 0 1-64.064 47.168l-199.701333 16.288a11.68 11.68 0 0 0-7.978667 4.181333 13.226667 13.226667 0 0 0 1.333334 18.261334l152.16 132.586666a77.141333 77.141333 0 0 1 24.277333 75.733334l-46.485333 198.229333a13.333333 13.333333 0 0 0 1.514666 9.877333c3.488 5.792 10.581333 7.530667 16.064 4.128l170.986667-106.229333a75.296 75.296 0 0 1 79.562667 0z"
                                            fill="#000000" p-id="5669"></path>
                                    </svg>
                                </div>
                                <div style="margin-left: 10px;">
                                    <span>收藏</span>
                                </div>
                            </div>
                            <div style="height: 40px;line-height: 40px;display: flex;margin-top: 5px;" class="menu-item"
                                @click="clickTag('/comment')">
                                <div style="height: 40px;margin-top: 5px;">
                                    <svg t="1731413463028" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                        xmlns="http://www.w3.org/2000/svg" p-id="3267" width="30" height="30">
                                        <path
                                            d="M896 128H128a32 32 0 0 0-32 32v576a32 32 0 0 0 32 32h288v-64H160V192h704v512h-256c-8.832 0-16.832 3.584-22.656 9.376l-159.968 160 45.248 45.248L621.248 768H896a32 32 0 0 0 32-32V160a32 32 0 0 0-32-32"
                                            fill="#181818" p-id="3268"></path>
                                        <path
                                            d="M560 448a48 48 0 1 0-95.968-0.032A48 48 0 0 0 560 448M240 448a48 48 0 1 0 95.968 0.032A48 48 0 0 0 240 448M784 448a48 48 0 1 0-95.968-0.032A48 48 0 0 0 784 448"
                                            fill="#181818" p-id="3269"></path>
                                    </svg>
                                </div>
                                <div style="margin-left: 10px;">
                                    <span>评论</span>
                                </div>
                            </div>
                            <div style="height: 40px;line-height: 40px;display: flex;margin-top: 5px;" class="menu-item"
                                @click="logout">
                                <div style="height: 40px;margin-top: 5px;">
                                    <svg t="1731482637324" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                        xmlns="http://www.w3.org/2000/svg" p-id="2352" width="30" height="30">
                                        <path
                                            d="M573.2 646.5H309.8c-12.6 0-20.8-5.8-22.9-16.1-0.4-2.1-0.4-4.2-0.4-6.4V397.2c0-14.3 7.8-22 22.3-22H573.1v-6.9-201.8c0-9.3 4.4-16.6 11.9-19.5 8.6-3.3 16.2-1.8 22.7 5.1 3.7 3.9 7.8 7.5 11.6 11.4 48.2 48.1 96.3 96.2 144.5 144.2 61.9 61.7 123.7 123.4 185.6 185.2 10.3 10.3 10.4 21.1 0.2 31.2-88.5 88.4-177 176.8-265.6 265.1-25.2 25.1-50.5 50.1-75.7 75.2-6.5 6.5-13.7 9.3-22.5 6-8.6-3.3-12.6-10-12.6-20.7V646.5z m-159-497.3v76.4H212.9c-41 0-71.3 30.3-71.3 71.4 0 142.3 0.3 284.6-0.2 426.9-0.1 37.7 28.5 64.8 55 69.7 5.9 1.1 11.9 1.6 17.9 1.6 64.2 0.1 128.4 0.1 192.6 0.1h7.2v76c-0.9 0.2-2 0.6-3 0.6-68.2 0-136.5 0.7-204.7-0.3-66.7-1-125.7-51.6-138.5-117.1-1.8-9.2-2.7-18.8-2.7-28.2-0.2-143.8-0.5-287.7 0.1-431.5 0.3-60.1 30.1-103.2 82.2-131.2 18.4-9.9 38.7-14.4 59.6-14.4 67.7-0.2 135.3-0.1 203-0.1 1.1 0 2.3 0.1 4.1 0.1z m0 0"
                                            p-id="2353"></path>
                                    </svg>
                                </div>
                                <div style="margin-left: 10px;">
                                    <span>退出登录</span>
                                </div>
                            </div>
                        </div>


                    </div>

                </div>
            </el-aside>
            <el-container>
                <el-header>
                    <!-- 头部 -->
                    <div style="display: flex;flex-direction: row;" @click="songListRight = -350">
                        <div @click="$router.go(-1)"
                            style="background-color: rgba(200, 200, 200,0.5);width: 40px;border-radius: 50%;height: 40px;line-height: 40px;margin-top: 10px; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.3);">
                            <i class="el-icon-arrow-left"></i>
                        </div>
                        <div @click="$router.go(1)"
                            style="background-color: rgba(200, 200, 200,0.5);width: 40px;border-radius: 50%;height: 40px;line-height: 40px;margin-top: 10px;margin-left: 10px; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.3);">
                            <i class="el-icon-arrow-right"></i>
                        </div>
                        <div
                            style="display: flex;flex-direction: row;margin-left: 50px;height: 40px;line-height: 40px;margin-top: 10px;">
                            <!-- 目录 -->
                            <div @click="clickTag('/')"
                                style="margin-left: 30px; background-color:rgba(200, 200, 200,0.2) ;box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.3);border-radius: 40px;width: 60px;">
                                首页
                            </div>
                            <div @click="clickTag('/singer')"
                                style="margin-left: 30px; background-color:rgba(200, 200, 200,0.2) ;box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.3);border-radius: 40px;width: 60px;">
                                歌手
                            </div>
                            <div @click="clickTag('/songList')"
                                style="margin-left: 30px; background-color:rgba(200, 200, 200,0.2) ;box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.3);border-radius: 40px;width: 60px;">
                                歌单
                            </div>

                        </div>
                        <div style=" margin-left: auto;margin-right: 80px;height: 60px;line-height: 60px;">
                            <el-input placeholder="请输入内容" v-model="search" class="input-with-select" clearable
                                style="box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.3);border-radius: 10px;">
                                <el-button slot="append" icon="el-icon-search" @click="searchSong()"></el-button>
                            </el-input>
                        </div>
                    </div>



                </el-header>
                <el-main @click="songListRight = -350">
                    <!-- <el-backtop target=".main" :visibility-height="10"></el-backtop> -->
                    <router-view class="main"></router-view>
                </el-main>
            </el-container>
        </el-container>
        <div class="tag" @click="toggleTag"
            :style="`position: absolute;bottom:${footerBottom + 100}px;transition: bottom 1s ease-in;`">
            <i :class="tagIcon" style="font-size: 30px;"></i>
        </div>


        <div class="footer" :style="`position: absolute;bottom:${footerBottom}px;transition: bottom 1s ease-in;`">
            <div style="display: flex;height: 80px;width: 90%;margin: 10px auto;">
                <div style="width: 20%;height: 100%;display: flex;">
                    <div style="background-color: cadetblue;width: 80px;border-radius: 10px;height: 100%;position: relative; display: inline-block;"
                        @mouseover="isOpenSongBox = true" @mouseleave="isOpenSongBox = false">
                        <!-- 歌曲图片 -->
                        <el-image style="width: 80px; height: 80px; border-radius: 10%;"
                            :src="'http://localhost:8080/api/files/' + playingMusic.pic">
                        </el-image>
                        <div v-if="isOpenSongBox" @click="openSongBox()"
                            style="position:absolute;top:0;height: 80px;width: 80px; display: flex;background-color: rgba(200, 200, 200,0.5);border-radius: 10px;">
                            <svg data-v-00a66cdf="" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"
                                stroke="currentColor" class="arco-icon arco-icon-expand" stroke-width="2"
                                stroke-linecap="butt" stroke-linejoin="miter"
                                style="font-size: 50px; color: rgb(255, 255, 255);z-index: 100000;">
                                <path d="M7 26v14c0 .552.444 1 .996 1H22m19-19V8c0-.552-.444-1-.996-1H26"></path>
                            </svg>
                        </div>

                    </div>
                    <div style="flex: 1; ">
                        <div style="margin-left: 20px;height: 80%;margin-top:5%;display: flex;flex-direction: column;">
                            <div style="font-size: 18px;font-weight: bolder;height: 25px;overflow: hidden;"
                                @click="clickMusicName(playingMusic)" class="music-name">
                                {{ playingMusic.name }}
                            </div>
                            <div style="margin-top: 15px;height: 20px;overflow: hidden;"
                                @click="clickSingerName(playingMusic)" class="singer-name">
                                {{ playingMusic.singerName }}
                            </div>
                        </div>
                    </div>
                </div>
                <div style="width: 60%;">
                    <div style="width: 90%;margin:0 auto;height: 100%;">
                        <!-- 歌曲进度条 -->
                        <div>
                            <div v-if="playingMusic.url != null">
                                <!-- <audio v-if="playingMusic.url.includes('song|')"
                                    :src="'http://localhost:8080/api/files/' + playingMusic.url" controls="controls"
                                    id="audio1">
                                </audio> -->
                                <audio :src="playingMusic.audioUrl" controls="controls" id="audio" ref="audioElement"
                                    @timeupdate="updateCurrentTime" hidden preload="auto" @ended="audioEnded">
                                    <source :src="playingMusic.audioUrl">
                                    您的浏览器不支持 audio 标签。
                                </audio>
                            </div>
                            <!-- <div v-else>暂无歌曲</div> -->
                        </div>
                        <div style="display: flex;flex-direction: column;width: 100%;height: 100%;">
                            <div style="height: 70%;width: 40%;margin: 0 auto;display: flex;">
                                <div style="width: 25%;height: 100%;">
                                    <div style="margin: 0 auto;width: 35px;height: 35px;margin-top:10px;"
                                        class="last-icon" @click="lastMusic">
                                        <svg t="1730986972484" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                            xmlns="http://www.w3.org/2000/svg" p-id="1301" width="35" height="35">
                                            <path
                                                d="M356.77 605.22L701.8 849.53c69.8 49.42 166.29-0.49 166.29-86.01V261.25c0-85.52-96.49-135.43-166.29-86.01L356.77 419.55c-64.02 45.34-64.02 140.34 0 185.67zM210.42 154.36c30.38 0 55 24.62 55 55v606.07c0 30.38-24.62 55-55 55s-55-24.62-55-55V209.36c0-30.38 24.62-55 55-55z"
                                                p-id="1302"></path>
                                        </svg>
                                    </div>

                                </div>
                                <div style="width: 50%;height: 100%">

                                    <div style="margin: 0 auto;width: 50px;height: 50px;margin-top: 3px;"
                                        class="play-icon" @click="playOrPause">
                                        <!-- {{ $store.state.play }} -->
                                        <svg v-if="!$store.state.isplay" t="1730986703357" class="icon"
                                            viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                                            p-id="927" width="50" height="50">
                                            <path
                                                d="M783.74 401.86L372.23 155.28c-85.88-51.46-195.08 10.41-195.08 110.53v493.16c0 100.12 109.2 161.99 195.08 110.53l411.51-246.58c83.5-50.04 83.5-171.03 0-221.06z"
                                                p-id="928" fill="#2c2c2c"
                                                data-spm-anchor-id="a313x.collections_detail.0.i0.43c33a81fsIjrG"
                                                class="selected"></path>
                                        </svg>
                                        <svg v-if="$store.state.isplay" t="1730989226232" class="icon"
                                            viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                                            p-id="1633" width="50" height="50">
                                            <path
                                                d="M332.26 853.89c-49.71 0-90-40.29-90-90v-503c0-49.71 40.29-90 90-90s90 40.29 90 90v503c0 49.7-40.3 90-90 90zM691.26 853.89c-49.71 0-90-40.29-90-90v-503c0-49.71 40.29-90 90-90s90 40.29 90 90v503c0 49.7-40.3 90-90 90z"
                                                p-id="1634"></path>
                                        </svg>
                                    </div>

                                </div>
                                <div style="width: 25%;height: 100%;;">
                                    <div style="margin: 0 auto;width: 35px;height: 35px;margin-top:10px;"
                                        class="next-icon" @click="nextMusic">
                                        <svg t="1730987216598" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                            xmlns="http://www.w3.org/2000/svg" p-id="1467" width="35" height="35">
                                            <path
                                                d="M665.47 417.65l-345.03-244.3c-69.8-49.42-166.29 0.49-166.29 86.01v502.27c0 85.52 96.49 135.43 166.29 86.01l345.03-244.31c64.02-45.34 64.02-140.34 0-185.68zM811.82 868.52c-30.38 0-55-24.62-55-55V207.46c0-30.38 24.62-55 55-55s55 24.62 55 55v606.07c0 30.37-24.62 54.99-55 54.99z"
                                                p-id="1468"></path>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                            <!-- 播放进度 -->
                            <div style="flex: 1;width: 100%;display: flex;">
                                <div style="height: 100%;width: 50px;">
                                    <span style="height: 38px;line-height: 38px;margin-left: 10px;">
                                        {{ formatDuration(currentTime.toFixed(0)) }}
                                    </span>

                                </div>
                                <div style="height: 100%;margin: 0 auto;flex: 1;">
                                    <el-slider v-model="currentTime" :show-tooltip="false"
                                        :max="playingMusic.audioDurationSeconds" @change="setAudioTime"
                                        :disabled="playingMusic.id == 0"></el-slider>
                                </div>
                                <div style="height: 100%;width: 50px;">
                                    <span style="height: 38px;line-height: 38px;margin-left: 10px;">
                                        {{ playingMusic.audioDuration }}
                                    </span>
                                </div>
                            </div>
                        </div>


                    </div>
                </div>


                <div style="width: 20%;display: flex;height: 100%;">
                    <div style="width: 100px;height: 100%;flex: 1;">
                        <!-- 其他按钮 -->
                        <div style="display: flex;height: 30px;width: auto;margin: 0 auto ;margin-top: 20px;">
                            <div style="margin-left: 30px;height: 40px;width: 40px;padding-left: 5px;padding-top: 5px;"
                                class="order-icon" @click="musicOrder()">
                                <!-- 单曲循环 -->
                                <svg v-if="musicLoop" t="1731071069690" class="icon" viewBox="0 0 1024 1024"
                                    version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1739" width="30" height="30">
                                    <path
                                        d="M361.5 727.8c-119.1 0-215.9-96.9-215.9-215.9 0-119.1 96.9-215.9 215.9-215.9 2.3 0 4.6-0.2 6.8-0.6v58.3c0 12.3 14 19.4 23.9 12.1l132.6-97.6c8.1-6 8.1-18.2 0-24.2l-132.6-97.6c-9.9-7.3-23.9-0.2-23.9 12.1v58.1c-2.2-0.4-4.5-0.6-6.8-0.6-39.8 0-78.5 7.9-115 23.4-35.2 15-66.8 36.3-94 63.5s-48.6 58.8-63.5 94c-15.5 36.5-23.4 75.2-23.4 115s7.9 78.5 23.4 115c15 35.2 36.3 66.8 63.5 94s58.8 48.6 94 63.5c36.5 15.5 75.2 23.4 115 23.4 22.1 0 40-17.9 40-40s-17.9-40-40-40z m576.7-330.9c-15-35.2-36.3-66.8-63.5-94s-58.8-48.6-94-63.5c-36.5-15.5-75.2-23.4-115-23.4-22.1 0-40 17.9-40 40s17.9 40 40 40c119.1 0 215.9 96.9 215.9 215.9 0 119.1-96.9 215.9-215.9 215.9-4.1 0-8.1 0.6-11.8 1.8v-60.8c0-12.3-14-19.4-23.9-12.1l-132.6 97.6c-8.1 6-8.1 18.2 0 24.2L629.9 876c9.9 7.3 23.9 0.2 23.9-12.1V806c3.7 1.2 7.7 1.8 11.8 1.8 39.8 0 78.5-7.9 115-23.4 35.2-15 66.8-36.3 94-63.5s48.6-58.8 63.5-94c15.5-36.5 23.4-75.2 23.4-115s-7.8-78.5-23.3-115z"
                                        p-id="1740" fill="#bf7fe3"></path>
                                    <path
                                        d="M512.8 660.6c22.1-0.1 39.9-18.1 39.8-40.2l-1.2-214.1c-0.1-22-18-39.8-40-39.8h-0.2c-22.1 0.1-39.9 18.1-39.8 40.2l1.2 214.1c0.1 22 18 39.8 40 39.8h0.2z"
                                        p-id="1741" fill="#bf7fe3"></path>
                                </svg>
                                <!-- 列表循环 -->
                                <svg v-if="!musicLoop" t="1731070889129" class="icon" viewBox="0 0 1024 1024"
                                    version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1517" width="30" height="30">
                                    <path
                                        d="M361.5 727.8c-119.1 0-215.9-96.9-215.9-215.9 0-119.1 96.9-215.9 215.9-215.9 2.3 0 4.6-0.2 6.8-0.6v58.3c0 12.3 14 19.4 23.9 12.1l132.6-97.6c8.1-6 8.1-18.2 0-24.2l-132.6-97.6c-9.9-7.3-23.9-0.2-23.9 12.1v58.1c-2.2-0.4-4.5-0.6-6.8-0.6-39.8 0-78.5 7.9-115 23.4-35.2 15-66.8 36.3-94 63.5s-48.6 58.8-63.5 94c-15.5 36.5-23.4 75.2-23.4 115s7.9 78.5 23.4 115c15 35.2 36.3 66.8 63.5 94s58.8 48.6 94 63.5c36.5 15.5 75.2 23.4 115 23.4 22.1 0 40-17.9 40-40s-17.9-40-40-40z m576.7-330.9c-15-35.2-36.3-66.8-63.5-94s-58.8-48.6-94-63.5c-36.5-15.5-75.2-23.4-115-23.4-22.1 0-40 17.9-40 40s17.9 40 40 40c119.1 0 215.9 96.9 215.9 215.9 0 119.1-96.9 215.9-215.9 215.9-4.1 0-8.1 0.6-11.8 1.8v-60.8c0-12.3-14-19.4-23.9-12.1l-132.6 97.6c-8.1 6-8.1 18.2 0 24.2L629.9 876c9.9 7.3 23.9 0.2 23.9-12.1V806c3.7 1.2 7.7 1.8 11.8 1.8 39.8 0 78.5-7.9 115-23.4 35.2-15 66.8-36.3 94-63.5s48.6-58.8 63.5-94c15.5-36.5 23.4-75.2 23.4-115s-7.8-78.5-23.3-115z"
                                        p-id="1518" data-spm-anchor-id="a313x.collections_detail.0.i5.76be3a81sbnCdm"
                                        class="selected" fill="#2c2c2c"></path>
                                </svg>
                            </div>
                            <div style="margin-left: 30px;height: 40px;width: 40px;padding-left: 5px;padding-top: 5px;"
                                class="sound-icon" @click="toggleMute">
                                <svg v-if="!isMuted" t="1731073024398" class="icon" viewBox="0 0 1024 1024"
                                    version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2879" width="30" height="30">
                                    <path
                                        d="M257.493333 322.4l215.573334-133.056c24.981333-15.413333 57.877333-7.914667 73.493333 16.746667 5.301333 8.373333 8.106667 18.048 8.106667 27.914666v555.989334C554.666667 819.093333 530.784 842.666667 501.333333 842.666667c-9.994667 0-19.786667-2.773333-28.266666-8L257.493333 701.6H160c-41.237333 0-74.666667-33.013333-74.666667-73.738667V396.138667c0-40.725333 33.429333-73.738667 74.666667-73.738667h97.493333z m26.133334 58.4a32.298667 32.298667 0 0 1-16.96 4.8H160c-5.888 0-10.666667 4.714667-10.666667 10.538667v231.733333c0 5.813333 4.778667 10.538667 10.666667 10.538667h106.666667c5.994667 0 11.872 1.664 16.96 4.8L490.666667 770.986667V253.013333L283.626667 380.8zM800.906667 829.653333a32.288 32.288 0 0 1-45.248-0.757333 31.317333 31.317333 0 0 1 0.768-44.693333c157.653333-150.464 157.653333-393.962667 0-544.426667a31.317333 31.317333 0 0 1-0.768-44.682667 32.288 32.288 0 0 1 45.248-0.757333c183.68 175.306667 183.68 460.010667 0 635.317333z m-106.901334-126.186666a32.288 32.288 0 0 1-45.248-1.216 31.328 31.328 0 0 1 1.237334-44.672c86.229333-80.608 86.229333-210.56 0-291.178667a31.328 31.328 0 0 1-1.237334-44.672 32.288 32.288 0 0 1 45.248-1.216c112.885333 105.546667 112.885333 277.418667 0 382.965333z"
                                        fill="#000000" p-id="2880"></path>
                                </svg>
                                <svg v-if="isMuted" t="1731073066103" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="3041" width="30" height="30">
                                    <path
                                        d="M257.493333 322.4l215.573334-133.056c24.981333-15.413333 57.877333-7.914667 73.493333 16.746667 5.301333 8.373333 8.106667 18.048 8.106667 27.914666v555.989334C554.666667 819.093333 530.784 842.666667 501.333333 842.666667c-9.994667 0-19.786667-2.773333-28.266666-8L257.493333 701.6H160c-41.237333 0-74.666667-33.013333-74.666667-73.738667V396.138667c0-40.725333 33.429333-73.738667 74.666667-73.738667h97.493333z m26.133334 58.4a32.298667 32.298667 0 0 1-16.96 4.8H160c-5.888 0-10.666667 4.714667-10.666667 10.538667v231.733333c0 5.813333 4.778667 10.538667 10.666667 10.538667h106.666667c5.994667 0 11.872 1.664 16.96 4.8L490.666667 770.986667V253.013333L283.626667 380.8zM832.565333 518.4l86.474667 86.474667a30.570667 30.570667 0 1 1-43.232 43.242666L789.333333 561.653333l-86.474666 86.474667a30.570667 30.570667 0 1 1-43.232-43.242667l86.474666-86.474666-86.474666-86.474667a30.570667 30.570667 0 1 1 43.232-43.232L789.333333 475.178667l86.474667-86.474667a30.570667 30.570667 0 1 1 43.232 43.232l-86.474667 86.474667z"
                                        fill="#bf7fe3" p-id="3042"></path>
                                </svg>
                            </div>
                        </div>

                    </div>
                    <div style="float: right;height: 100%;width: 60px;">
                        <!-- 播放列表按钮 -->
                        <div style="height: 50px;width: 50px;margin-top: 15px;margin-left: 15px;padding-left: 10px;padding-top: 10px;"
                            @click="songListRight = songListRight === 0 ? -350 : 0" class="song-list-icon">

                            <svg t="1730885207826" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="2369" width="30" height="30">
                                <path
                                    d="M187.392 70.656q28.672 0 48.64 19.456t19.968 48.128l0 52.224q0 28.672-19.968 48.64t-48.64 19.968l-54.272 0q-27.648 0-47.616-19.968t-19.968-48.64l0-52.224q0-28.672 19.968-48.128t47.616-19.456l54.272 0zM889.856 70.656q27.648 0 47.616 19.456t19.968 48.128l0 52.224q0 28.672-19.968 48.64t-47.616 19.968l-437.248 0q-28.672 0-48.64-19.968t-19.968-48.64l0-52.224q0-28.672 19.968-48.128t48.64-19.456l437.248 0zM187.392 389.12q28.672 0 48.64 19.968t19.968 48.64l0 52.224q0 27.648-19.968 47.616t-48.64 19.968l-54.272 0q-27.648 0-47.616-19.968t-19.968-47.616l0-52.224q0-28.672 19.968-48.64t47.616-19.968l54.272 0zM889.856 389.12q27.648 0 47.616 19.968t19.968 48.64l0 52.224q0 27.648-19.968 47.616t-47.616 19.968l-437.248 0q-28.672 0-48.64-19.968t-19.968-47.616l0-52.224q0-28.672 19.968-48.64t48.64-19.968l437.248 0zM187.392 708.608q28.672 0 48.64 19.968t19.968 47.616l0 52.224q0 28.672-19.968 48.64t-48.64 19.968l-54.272 0q-27.648 0-47.616-19.968t-19.968-48.64l0-52.224q0-27.648 19.968-47.616t47.616-19.968l54.272 0zM889.856 708.608q27.648 0 47.616 19.968t19.968 47.616l0 52.224q0 28.672-19.968 48.64t-47.616 19.968l-437.248 0q-28.672 0-48.64-19.968t-19.968-48.64l0-52.224q0-27.648 19.968-47.616t48.64-19.968l437.248 0z"
                                    p-id="2370" fill="#2c2c2c"></path>
                            </svg>
                        </div>
                    </div>
                </div>

            </div>
        </div>


        <div class="songList" :style="`position: absolute;right:${songListRight}px;transition: right 0.5s ease-in;`">
            <div>
                <h1 style="margin: 0 30%;">播放列表</h1>
            </div>
            <div style="height: 75vh;width: 80%;margin: 0 auto;margin-top: 30px;">
                <div style="height: 30px;width: 100%;">
                    <div class="clear" @click="clearList">
                        清空列表
                    </div>
                </div>
                <div
                    style="max-height: 90%;overflow-y: auto;scrollbar-width: none;-ms-overflow-style: none;overflow: -moz-scrollbars-none;">
                    <div v-for="item in musicList" :key="item.id"
                        style="height: 50px;width: 100%;display: flex;margin-top: 5px;padding-left: 10px;"
                        class="music-item">
                        <div style="width: 40px;height: 40px;" @click="clickItem(item)">
                            <el-image style="width: 40px; height: 40px; border-radius: 10%;margin-top: 5px;"
                                :src="'http://localhost:8080/api/files/' + item.pic">
                            </el-image>
                        </div>
                        <div
                            style="height: 80%;width: 190px;display: flex;margin-left: 10px;margin-top: 5px;flex-direction: column;flex: 1;">
                            <div style="margin: 0 auto;width: 100%;height: 50%;overflow: hidden;font-size: 14px;"
                                @click="clickMusicName(item)" class="music-name">
                                {{ item.name }}
                            </div>
                            <div style="margin: 0 auto;width: 100%;height: 40%;overflow: hidden;font-size: 10px;margin-top: 7px"
                                @click="clickSingerName(item)" class="singer-name">
                                {{ item.singerName }}——{{ item.introductions }}
                            </div>

                        </div>
                        <div style="width: 30px;height: 30px;margin-top: 10px;margin-right: 10px; padding-top: 5px;padding-left: 5px;"
                            class="detail-icon">
                            <el-popover placement="left" width="200" trigger="hover" class="detail-popover">
                                <div style="display: flex;flex-direction: column;">
                                    <div style="height: 50px;width: 100%;display: flex;">
                                        <div style="width: 40px;height: 40px;" @click="clickItem(item)">
                                            <el-image
                                                style="width: 40px; height: 40px; border-radius: 10%;margin-top: 5px;"
                                                :src="'http://localhost:8080/api/files/' + item.pic">
                                            </el-image>
                                        </div>
                                        <div
                                            style="height: 80%;width: 190px;display: flex;margin-left: 10px;margin-top: 5px;flex-direction: column;flex: 1;">
                                            <div style="margin: 0 auto;width: 100%;height: 50%;overflow: hidden;font-size: 14px;"
                                                @click="clickMusicName(item)" class="music-name">
                                                {{ item.name }}
                                            </div>
                                            <div style="margin: 0 auto;width: 100%;height: 40%;overflow: hidden;font-size: 10px;margin-top: 7px"
                                                @click="clickSingerName(item)" class="singer-name">
                                                {{ item.singerName }}——{{ item.introductions }}
                                            </div>

                                        </div>
                                    </div>
                                    <div style="border-bottom:1px darkgray solid;"></div>
                                    <div class="play-btn" @click="clickItem(item)"
                                        style="display:flex;height: 30px;width: 90%;padding-top: 5px;padding-left: 10px;margin: 2px auto;">
                                        <div>
                                            <svg t="1731298449347" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                                xmlns="http://www.w3.org/2000/svg" p-id="1457" width="20" height="20">
                                                <path
                                                    d="M783.74 401.86L372.23 155.28c-85.88-51.46-195.08 10.41-195.08 110.53v493.16c0 100.12 109.2 161.99 195.08 110.53l411.51-246.58c83.5-50.04 83.5-171.03 0-221.06z"
                                                    p-id="1458"></path>
                                            </svg>
                                        </div>
                                        <span style="margin-left: 10px;">播放</span>
                                    </div>
                                    <div class="play-btn" @click="removeItem(item)"
                                        style="display:flex;height: 30px;width: 90%;padding-top: 5px;padding-left: 10px;margin: 2px auto;">
                                        <div>
                                            <svg t="1731298766910" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                                xmlns="http://www.w3.org/2000/svg" p-id="1623" width="20" height="20">
                                                <path
                                                    d="M857.99 286.99H724.6v-27.6c0-62.53-50.87-113.4-113.4-113.4H409.78c-62.53 0-113.4 50.87-113.4 113.4v27.6h-133.4c-23.47 0-42.5 19.03-42.5 42.5s19.03 42.5 42.5 42.5h53.25L265.87 837c2.31 21.6 20.53 37.99 42.26 37.99h404c21.7 0 39.92-16.35 42.25-37.93l50.29-465.07h53.31c23.47 0 42.5-19.03 42.5-42.5s-19.02-42.5-42.49-42.5z m-476.61-27.6c0-15.66 12.74-28.4 28.4-28.4H611.2c15.66 0 28.4 12.74 28.4 28.4v27.6H381.38v-27.6z m292.6 530.6H346.34l-44.62-418h417.46l-45.2 418z"
                                                    p-id="1624"></path>
                                                <path
                                                    d="M430.99 445.99c-23.47 0-42.5 19.03-42.5 42.5v146c0 23.47 19.03 42.5 42.5 42.5s42.5-19.03 42.5-42.5v-146c0-23.47-19.03-42.5-42.5-42.5zM589.99 445.99c-23.47 0-42.5 19.03-42.5 42.5v146c0 23.47 19.03 42.5 42.5 42.5s42.5-19.03 42.5-42.5v-146c0-23.47-19.03-42.5-42.5-42.5z"
                                                    p-id="1625"></path>
                                            </svg>
                                        </div>
                                        <span style="margin-left: 10px;">从播放列表中移除</span>
                                    </div>
                                    <div style="border-bottom:1px darkgray solid;"></div>
                                    <div class="play-btn" @click="addSong2Collect(item)"
                                        style="display:flex;height: 30px;width: 90%;padding-top: 5px;padding-left: 10px;margin: 2px auto;">
                                        <div>
                                            <svg t="1731299241051" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                                xmlns="http://www.w3.org/2000/svg" p-id="5668" width="20" height="20">
                                                <path
                                                    d="M335.008 916.629333c-35.914667 22.314667-82.88 10.773333-104.693333-25.557333a77.333333 77.333333 0 0 1-8.96-57.429333l46.485333-198.24a13.141333 13.141333 0 0 0-4.021333-12.864l-152.16-132.586667c-31.605333-27.52-35.253333-75.648-8.234667-107.733333a75.68 75.68 0 0 1 51.733333-26.752L354.848 339.2c4.352-0.362667 8.245333-3.232 10.026667-7.594667l76.938666-188.170666c16.032-39.2 60.618667-57.92 99.52-41.461334a76.309333 76.309333 0 0 1 40.832 41.461334l76.938667 188.16c1.781333 4.373333 5.674667 7.253333 10.026667 7.605333l199.712 16.277333c41.877333 3.413333 72.885333 40.458667 69.568 82.517334a76.938667 76.938667 0 0 1-26.08 51.978666l-152.16 132.586667c-3.541333 3.082667-5.141333 8.074667-4.021334 12.853333l46.485334 198.24c9.621333 41.013333-15.36 82.336-56.138667 92.224a75.285333 75.285333 0 0 1-57.525333-9.237333l-170.976-106.24a11.296 11.296 0 0 0-12.010667 0l-170.986667 106.24zM551.786667 756.032l170.976 106.24c2.624 1.621333 5.717333 2.122667 8.650666 1.408 6.410667-1.557333 10.56-8.426667 8.928-15.424l-46.485333-198.24a77.141333 77.141333 0 0 1 24.277333-75.733333L870.293333 441.706667c2.485333-2.165333 4.053333-5.312 4.330667-8.746667 0.565333-7.136-4.490667-13.173333-10.976-13.696l-199.712-16.288a75.989333 75.989333 0 0 1-64.064-47.168l-76.938667-188.16a12.309333 12.309333 0 0 0-6.538666-6.741333c-5.898667-2.496-12.725333 0.373333-15.328 6.741333l-76.949334 188.16a75.989333 75.989333 0 0 1-64.064 47.168l-199.701333 16.288a11.68 11.68 0 0 0-7.978667 4.181333 13.226667 13.226667 0 0 0 1.333334 18.261334l152.16 132.586666a77.141333 77.141333 0 0 1 24.277333 75.733334l-46.485333 198.229333a13.333333 13.333333 0 0 0 1.514666 9.877333c3.488 5.792 10.581333 7.530667 16.064 4.128l170.986667-106.229333a75.296 75.296 0 0 1 79.562667 0z"
                                                    fill="#000000" p-id="5669"></path>
                                            </svg>
                                        </div>
                                        <span style="margin-left: 10px;">添加至收藏</span>
                                    </div>
                                    <div class="play-btn" @click="copyText(item)"
                                        style="display:flex;height: 30px;width: 90%;padding-top: 5px;padding-left: 10px;margin: 2px auto;">
                                        <div>
                                            <svg t="1731299271839" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                                xmlns="http://www.w3.org/2000/svg" p-id="5830" width="20" height="20">
                                                <path
                                                    d="M394.666667 106.666667h448a74.666667 74.666667 0 0 1 74.666666 74.666666v448a74.666667 74.666667 0 0 1-74.666666 74.666667H394.666667a74.666667 74.666667 0 0 1-74.666667-74.666667V181.333333a74.666667 74.666667 0 0 1 74.666667-74.666666z m0 64a10.666667 10.666667 0 0 0-10.666667 10.666666v448a10.666667 10.666667 0 0 0 10.666667 10.666667h448a10.666667 10.666667 0 0 0 10.666666-10.666667V181.333333a10.666667 10.666667 0 0 0-10.666666-10.666666H394.666667z m245.333333 597.333333a32 32 0 0 1 64 0v74.666667a74.666667 74.666667 0 0 1-74.666667 74.666666H181.333333a74.666667 74.666667 0 0 1-74.666666-74.666666V394.666667a74.666667 74.666667 0 0 1 74.666666-74.666667h74.666667a32 32 0 0 1 0 64h-74.666667a10.666667 10.666667 0 0 0-10.666666 10.666667v448a10.666667 10.666667 0 0 0 10.666666 10.666666h448a10.666667 10.666667 0 0 0 10.666667-10.666666v-74.666667z"
                                                    fill="#000000" p-id="5831"></path>
                                            </svg>
                                        </div>
                                        <span style="margin-left: 10px;">复制歌曲名</span>
                                    </div>
                                    <div class="play-btn" @click="downUrl(item.audioUrl)"
                                        style="display:flex;height: 30px;width: 90%;padding-top: 5px;padding-left: 10px;margin: 2px auto;">
                                        <div>
                                            <svg t="1731299458029" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                                xmlns="http://www.w3.org/2000/svg" p-id="3267" width="20" height="20">
                                                <path
                                                    d="M832 768v64H192v-64H128v128h768v-128zM822.624 438.624l-45.248-45.248L544 626.752V128h-64v498.752l-233.376-233.376-45.248 45.248L512 749.248z"
                                                    fill="#181818" p-id="3268"></path>
                                            </svg>
                                        </div>
                                        <span style="margin-left: 10px;">下载</span>
                                    </div>
                                </div>

                                <div slot="reference">
                                    <svg t="1731295289629" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                        xmlns="http://www.w3.org/2000/svg" p-id="3208" width="20" height="20">
                                        <path d="M509.9 512m-111 0a111 111 0 1 0 222 0 111 111 0 1 0-222 0Z" fill=""
                                            p-id="3209"></path>
                                        <path d="M849.1 512m-111 0a111 111 0 1 0 222 0 111 111 0 1 0-222 0Z" fill=""
                                            p-id="3210"></path>
                                        <path d="M174.9 512m-111 0a111 111 0 1 0 222 0 111 111 0 1 0-222 0Z" fill=""
                                            p-id="3211"></path>
                                    </svg>
                                </div>
                            </el-popover>
                        </div>
                    </div>

                </div>
            </div>
            <div style="height: 15vh;">

            </div>

        </div>

        <div class="songBox" :style="`position: absolute;bottom:${songBoxBottom};transition: bottom 0.5s ease-in;`">
            <div style="display: flex;width: 90%;height: 90%;margin: 2% auto">
                <div style="height: 100%;width: 400px;display: flex;flex-direction: column;">
                    <div style="width: 300px;height: 300px;margin-top: 50px;margin-left: 50px;">
                        <el-image style="width: 300px; height: 300px; border-radius: 10%;"
                            :src="'http://localhost:8080/api/files/' + playingMusic.pic">
                        </el-image>
                    </div>
                    <div>
                        <div style="margin-left: 50px;height: 80%;margin-top:5%;display: flex;flex-direction: column;">
                            <div style="font-size: 28px;font-weight: bolder;height: 50px;overflow: hidden;line-height: 50px;"
                                @click="clickMusicName(playingMusic)" class="music-name">
                                {{ playingMusic.name }}
                            </div>
                            <div style="margin-top: 15px;height: 30px;overflow: hidden;font-size: 20px;"
                                @click="clickSingerName(playingMusic)" class="singer-name">
                                {{ playingMusic.singerName }}
                            </div>
                            <div
                                style="margin-top: 25px;height: 30px;overflow: hidden;font-size: 20px;line-height: 30px;color:  #d392f8;">
                                {{ currentLyric }}
                            </div>
                        </div>
                    </div>
                </div>
                <div style="flex: 1;height: 100%">
                    <div v-if="lyricList.length == 0">
                        <div style="width: 100%;height: 80px;margin: 0 auto;text-align: center;margin-top: 250px;">
                            <h1>暂无歌词</h1>
                        </div>
                    </div>
                    <div v-else>
                        <div style="width: 90%;max-height: 500px;margin: 0 auto;
                            border-radius: 20px;width: 100%;margin-top: 5%;">
                            <div style="width: 100%;max-height: 500px;margin: 0 auto;overflow-y: auto;"
                                class="lyric-list" ref="lyricsContainer">
                                <div v-for="(item, index) in lyricList" :key="item.id" class="lyricDiv"
                                    @click="clickLyric(item)">
                                    <div
                                        style="display: flex;width: 60%;margin: 0 auto;font-size: 25px;overflow: hidden;">
                                        <!-- <div
                                            style="width: 80px;height: 60px;line-height: 60px;text-align: center;overflow: hidden;">
                                            {{ item.time }}
                                        </div> -->

                                        <div v-if="index == currentLineIndex"
                                            style="flex: 1;height: 60px;line-height: 60px;margin-left: 20px;overflow: hidden;font-size: 40px;color:#d392f8 ;">
                                            {{ item.lyric }}
                                        </div>
                                        <div v-else
                                            style="flex: 1;height: 60px;line-height: 60px;margin-left: 20px;overflow: hidden;">
                                            {{ item.lyric }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>



</template>
<!-- -------------------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------------------- -->
<script>
import request from '@/utils/request';
export default {
    name: 'Layout',
    data() {
        return {
            isNameVisible: false,
            observer: null,
            user: localStorage.getItem("user") ? JSON.parse(localStorage.getItem("user")) : '',
            tagIcon: 'el-icon-arrow-down',
            footerBottom: 0,
            songListRight: -350,
            musicList: localStorage.getItem("musicList") ? JSON.parse(localStorage.getItem("musicList")) : [],
            playingMusic: localStorage.getItem("playingMusic") != undefined ? JSON.parse(localStorage.getItem("playingMusic")) : JSON.parse(localStorage.getItem("musicList")).length == 0 ? { id: 0 } : JSON.parse(localStorage.getItem("musicList"))[0],
            // play: false,
            // schedule: 0,
            currentTime: 0,
            musicLoop: false,
            isMuted: false,
            search: '',
            isOpenSongBox: false,
            songBoxBottom: "-100%",
            // songBoxBottom: "100px",
            lyricList: [],
            currentLineIndex: 0, // 当前歌词行索引
            currentLyric: '',

        }
    },
    // props: {
    //     singer: {
    //         type: Object,
    //         required: true
    //     }
    // },
    // mounted() {
    //     this.initIntersectionObserver();
    // },
    // beforeDestroy() {
    //     this.observer.disconnect();
    // },
    // 可以设置一个定时器定期检查localStorage的变化
    async mounted() {
        // this.interval = setInterval(this.checkLocalStorage, 1000); // 每秒检查一次
        this.interval1 = setInterval(this.initPlay, 500);
        this.$store.commit('updateIsplay', false);
        this.playingMusic = localStorage.getItem("playingMusic") != undefined ? JSON.parse(localStorage.getItem("playingMusic")) : JSON.parse(localStorage.getItem("musicList")).length == 0 ? { id: 0 } : JSON.parse(localStorage.getItem("musicList"))[0];
        this.initNotice();

    },
    created() {
        window.addEventListener('storage', this.handleStorageChange);
    },
    beforeDestroy() {
        // 清除定时器
        clearInterval(this.interval);
        clearInterval(this.interval1);
    },

    watch: {
        // 监听musicList变化
        musicList: {
            handler(newValue, oldValue) {
                console.log('musicList changed:', newValue);

                // 当musicList变化时，更新localStorage
                localStorage.setItem("musicList", JSON.stringify(newValue));
            },
            deep: true // 开启深度监听
        },
        playingMusic: {
            handler(newValue, oldValue) {
                // 当playingMusic变化时，更新localStorage
                // localStorage.setItem("playingMusic", JSON.stringify(newValue));
                // console.log(newValue);
                if (newValue.id !== 0) {
                    this.updateSongClicks(newValue);
                }
                this.initLyric();
            },
            deep: true
        },
        songListRight(newValue, oldValue) {
            if (newValue === 0) {
                this.interval = setInterval(this.checkLocalStorage, 500);
            } else {
                clearInterval(this.interval);
            }
        },
        '$store.state.isplay'(newValue, oldValue) {
            let audio = '';
            if (this.playingMusic.audioUrl.includes('http')) {
                audio = document.getElementById('audio');
            } else {
                return
            }
            if (newValue) {
                // console.log('开始播放');
                setTimeout(() => {
                    audio.play();
                }, 200)
            } else {
                // console.log('暂停播放');

                audio.pause();
            }
        }

    },
    methods: {
        clickTag(path) {
            if (path === this.$route.path) {
                return;
            } else {
                this.$router.push(path);
            }
        },
        initIntersectionObserver() {
            const targetElement = document.querySelector('.singer-name-target');

            if (!targetElement) {
                console.error('Target element not found');
                return;
            }

            this.observer = new IntersectionObserver(
                (entries) => {
                    entries.forEach(entry => {
                        this.isNameVisible = entry.isIntersecting;
                    });
                },
                { threshold: 0.1 }
            );

            this.observer.observe(targetElement);
        },
        toggleTag() {
            this.tagIcon = this.tagIcon === 'el-icon-arrow-up' ? 'el-icon-arrow-down' : 'el-icon-arrow-up';
            this.footerBottom = this.footerBottom === 0 ? -100 : 0;
            this.songListRight = -350;
        },
        checkLocalStorage() {
            // 获取当前localStorage中的musicList
            let currentMusicList = localStorage.getItem("musicList") ? JSON.parse(localStorage.getItem("musicList")) : [];
            // 如果当前musicList与组件中的musicList不一致，则更新组件中的musicList
            if (JSON.stringify(currentMusicList) !== JSON.stringify(this.musicList)) {
                this.musicList = currentMusicList;
                //  console.log(this.musicList);

            }
        },
        clearList() {
            this.$store.commit('updateIsplay', false);
            this.currentTime = 0.00;
            localStorage.removeItem('musicList');
            localStorage.setItem('musicList', JSON.stringify([]));
            localStorage.setItem('playingMusic', JSON.stringify({ id: 0 }));
        },
        // 跳转到歌曲详情页
        clickMusicName(item) {
            // console.log(item);
            let path = '/songDetails?songId=' + item.id;
            if (path === this.$route.fullPath) {
                return;
            } else {
                // console.log(path);
                this.$router.push({
                    path: '/songDetails',
                    query: {
                        songId: item.id
                    }
                })
                // this.$router.push(path);
            }

        },
        // 跳转到歌手详情页
        clickSingerName(item) {
            let path = '/singerDetails?singerId=' + item.singerId;
            if (path === this.$route.fullPath) {
                return;
            } else {
                // console.log(path);
                this.$router.push({
                    path: '/singerDetails',
                    query: {
                        singerId: item.singerId
                    }
                })
                // this.$router.push(path);
            }
        },
        // 添加到播放器
        clickItem(item) {
            this.$store.commit('updateIsplay', false);
            localStorage.setItem("playingMusic", JSON.stringify(item));
        },
        initPlay() {
            // console.log(this.musicList);


            // console.log(JSON.parse(localStorage.getItem("musicList"))[0]);
            // if(JSON.parse(localStorage.getItem("playingMusic"))==null){
            //     localStorage.setItem("playingMusic", JSON.stringify({ id: 0 }));
            // }
            if (this.playingMusic == undefined) {
                localStorage.setItem("playingMusic", JSON.stringify({ id: 0 }));
                this.playingMusic = JSON.parse(localStorage.getItem("playingMusic"));
                return;
            }
            if (this.playingMusic == undefined && this.playingMusic.id === 0 && this.musicList.length !== 0) {
                this.playingMusic = this.musicList[0];
                // console.log(this.playingMusic);

                return;
            }
            // console.log(JSON.parse(localStorage.getItem("playingMusic")));
            // console.log(JSON.parse(localStorage.getItem("musicList")));


            let tmp = localStorage.getItem("playingMusic") != undefined ? JSON.parse(localStorage.getItem("playingMusic")) : JSON.parse(localStorage.getItem("musicList")) == [] || JSON.parse(localStorage.getItem("musicList")).length == 0 ? { id: 0 } : JSON.parse(localStorage.getItem("musicList"))[0];
            if (tmp.id === this.playingMusic.id) {
            } else {
                console.log(tmp);
                this.playingMusic = tmp;
            }
        },
        playOrPause() {
            // console.log(this.playingMusic);

            if (this.playingMusic.id !== 0 && this.playingMusic.url !== '') {
                this.$store.commit('updateIsplay', !this.$store.state.isplay);
                // console.log(this.$play);
                // this.play=this.$play;
                // let audio = '';

                // if (this.playingMusic.audioUrl.includes('http')) {
                //     audio = document.getElementById('audio');
                // } else {
                //     return
                // }
                // if (this.$store.state.isplay) {
                //     audio.play();
                // } else {
                //     audio.pause();
                // }
            } else {
                this.$message({
                    message: '请先添加歌曲',
                    type: 'warning'
                });
            }

        },
        updateCurrentTime() {
            // 使用Vue的$refs来访问DOM元素，获取currentTime
            this.currentTime = this.$refs.audioElement.currentTime;
            setTimeout(() => {
                this.updateLyrics(this.currentTime);
            }, 100);

            // if (this.formatDuration(this.currentTime.toFixed(0)) === this.playingMusic.audioDuration) {
            //     if (this.musicLoop != true) {
            //         console.log('播放下一首');
            //         this.nextMusic();
            //     } else {
            //         this.currentTime = 0;
            //         let audio = '';
            //         if (this.playingMusic.audioUrl != null && this.playingMusic.audioUrl.includes('http')) {
            //             audio = document.getElementById('audio');
            //             setTimeout(() => {
            //                 audio.play();
            //             }, 200)
            //         }
            //     }

            // }
        },
        audioEnded() {
            if (this.musicLoop != true) {
                console.log('播放下一首');
                this.nextMusic();
            } else {
                this.currentTime = 0;
                let audio = '';
                if (this.playingMusic.audioUrl != null && this.playingMusic.audioUrl.includes('http')) {
                    audio = document.getElementById('audio');
                    setTimeout(() => {
                        audio.play();
                    }, 200)
                }
            }
        },
        // 节流
        setAudioTime(value) {
            // 使用requestAnimationFrame来更新currentTime
            requestAnimationFrame(() => {
                this.$refs.audioElement.currentTime = value;
            });
        },
        formatDuration(seconds) {
            if (seconds === null || seconds === undefined) {
                return '未知';
            }
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;
        },
        lastMusic() {
            // console.log(JSON.parse(localStorage.getItem("musicList")));

            if (localStorage.getItem("musicList") == null || JSON.parse(localStorage.getItem("musicList")).length === 0) {


                return;
            }
            if (this.musicLoop === true) {
                this.currentTime = 0;
                let audio = '';
                if (this.playingMusic.audioUrl != null && this.playingMusic.audioUrl.includes('http')) {
                    audio = document.getElementById('audio');
                    setTimeout(() => {
                        audio.play();
                        this.$store.commit('updateIsplay', true);
                    }, 200)
                }
            } else {
                let audio = '';
                if (this.playingMusic.audioUrl != null && this.playingMusic.audioUrl.includes('http')) {
                    audio = document.getElementById('audio');
                    setTimeout(() => {
                        audio.pause();
                    }, 200)
                }
                this.musicList = localStorage.getItem("musicList") ? JSON.parse(localStorage.getItem("musicList")) : [];
                let index = this.musicList.findIndex(item => item.id === this.playingMusic.id);
                if (index === 0) {
                    let item = this.musicList[this.musicList.length - 1];
                    this.playingMusic = item;
                    localStorage.setItem("playingMusic", JSON.stringify(item));

                } else {
                    let item = this.musicList[index - 1];
                    this.playingMusic = item;
                    localStorage.setItem("playingMusic", JSON.stringify(item));
                }
                if (this.$store.state.isplay == false) {
                    this.$store.commit('updateIsplay', true);
                }
                if (this.playingMusic.audioUrl != null && this.playingMusic.audioUrl.includes('http')) {
                    audio = document.getElementById('audio');
                    setTimeout(() => {
                        audio.play();
                    }, 200)
                }
            }

        },
        nextMusic() {
            if (localStorage.getItem("musicList") == null || JSON.parse(localStorage.getItem("musicList")).length === 0) {
                return;
            }
            if (this.musicLoop === true) {
                this.currentTime = 0;
                let audio = '';
                if (this.playingMusic.audioUrl != null && this.playingMusic.audioUrl.includes('http')) {
                    audio = document.getElementById('audio');
                    setTimeout(() => {
                        audio.play();
                        this.$store.commit('updateIsplay', true);
                    }, 200)
                }
            } else {
                let audio = '';
                if (this.playingMusic.audioUrl != null && this.playingMusic.audioUrl.includes('http')) {
                    audio = document.getElementById('audio');
                    setTimeout(() => {
                        audio.pause();
                    }, 200)
                }
                this.musicList = localStorage.getItem("musicList") ? JSON.parse(localStorage.getItem("musicList")) : [];
                let index = this.musicList.findIndex(item => item.id === this.playingMusic.id);
                if (index === this.musicList.length - 1) {
                    let item = this.musicList[0];
                    this.playingMusic = item;
                    localStorage.setItem("playingMusic", JSON.stringify(item));

                } else {
                    let item = this.musicList[index + 1];
                    this.playingMusic = item;
                    localStorage.setItem("playingMusic", JSON.stringify(item));
                }
                if (this.$store.state.isplay == false) {
                    this.$store.commit('updateIsplay', true);
                }
                if (this.playingMusic.audioUrl != null && this.playingMusic.audioUrl.includes('http')) {
                    audio = document.getElementById('audio');
                    setTimeout(() => {
                        audio.play();
                    }, 200)
                }
            }


        },
        musicOrder() {
            this.musicLoop = !this.musicLoop;
        },
        toggleMute() {
            // 获取audio元素
            let audio = '';
            if (this.playingMusic.audioUrl != null && this.playingMusic.audioUrl.includes('http')) {
                audio = document.getElementById('audio');
            }
            // 切换muted属性
            this.isMuted = !this.isMuted;
            audio.muted = this.isMuted;
        },
        updateSongClicks(item) {
            request.post("/song/clicks", item).then(res => {
                if (res.code === '0') {

                } else {
                    this.$message({
                        message: res.msg,
                        type: 'error'
                    });
                }
            })
        },
        copyText(item) {
            let text = item.name + "——" + item.singerName + "——" + item.introduction;
            if (!navigator.clipboard) {
                this.$message({
                    message: '您的浏览器不支持此功能',
                    type: 'error'
                });
                return;
            }
            navigator.clipboard.writeText(text).then(() => {

                this.$message({
                    message: '复制成功，内容为：' + text,
                    type: 'success'
                });
            }).catch(err => {

                this.$message({
                    message: '复制失败',
                    type: 'error'
                });
            });
        },
        downUrl(url) {
            if (url.includes('http')) {
                location.href = url;
            } else {
                this.$message({
                    message: '下载失败',
                    type: 'error'
                });
            }
        },
        removeItem(item1) {
            const musicList = JSON.parse(localStorage.getItem('musicList'));

            // 如果musicList存在且不为空，则过滤掉特定id的项
            if (musicList && musicList.length > 0) {
                const updatedMusicList = musicList.filter(item => item.id !== item1.id);

                // 将更新后的数组保存回localStorage
                localStorage.setItem('musicList', JSON.stringify(updatedMusicList));
            }
        },
        addSong2Collect(item) {
            // console.log(item);

            let c = {
                songId: item.id,
                userId: this.user.id
            }
            request.post("/collect", c).then(res => {
                if (res.code === '0') {
                    this.$message({
                        message: '收藏成功',
                        type: 'success'
                    });
                } else {
                    this.$message({
                        message: res.msg,
                        type: 'error'
                    })
                }
            })
        },
        searchSong() {
            // console.log(this.search);
            if (this.search == '') {
                this.$message({
                    message: '请输入搜索内容',
                    type: 'error'
                });
                return;
            }
            this.$router.push({
                path: '/search',
                query: {
                    search: this.search
                }
            })
            this.search = '';
        },
        login() {
            // console.log(this.$route);

            if (this.$route.path === '/login') {
                return;
            }
            this.$router.push('/login')
        },
        handleStorageChange(event) {
            // console.log('storage changed', event);

            if (event.key === 'user') {
                this.user = event.newValue ? JSON.parse(event.newValue) : '';
            }
            if (event.key === 'musicList') {


                this.musicList = event.newValue ? JSON.parse(event.newValue) : [];
            }

        },
        logout() {
            localStorage.removeItem('user');
            window.location.reload();
        },

        // 初始公告
        initNotice() {
            request.get("/notice/top/3").then(res => {
                if (res.code === '0') {
                    let notice = res.data;
                    // console.log(notice);
                    for (let i = 0; i < notice.length; i++) {
                        // console.log(notice[i]);
                        let obj = notice[i];
                        setTimeout(() => {
                            this.$notify({
                                title: obj.name,
                                message: obj.content,
                                offset: 50
                            });
                        }, 1);

                    }
                }
            })
        },
        openSongBox() {
            // console.log('open');
            this.songBoxBottom = this.songBoxBottom === '100px' ? "-100%" : "100px";
            if (this.songBoxBottom === '100px') {
                this.initLyric();
            }


        },
        initLyric() {
            // console.log(this.songId);
            if (this.playingMusic.id !== 0) {
                request.get("/song/lyric/" + this.playingMusic.id).then(res => {
                    if (res.code === '0') {
                        this.lyricList = res.data;
                        // console.log(res.data);

                    } else {
                        this.$message({
                            message: res.msg,
                            type: 'error'
                        });
                    }

                })
            }


        },
        clickLyric(item) {
            // console.log(item);

            // console.log(this.convertToSeconds(item.time));

            requestAnimationFrame(() => {
                this.$refs.audioElement.currentTime = this.convertToSeconds(item.time);
            });
        },
        convertToSeconds(timeString) {
            const parts = timeString.split(':');
            let seconds = 0;

            if (parts.length === 2) {
                const [minutes, secondsWithMillis] = parts;
                const secondsPart = secondsWithMillis.split('.');
                const minutesInSeconds = parseInt(minutes, 10) * 60;
                const secondsOnly = parseInt(secondsPart[0], 10);
                const millis = parseInt(secondsPart[1], 10) / 1000;

                seconds = minutesInSeconds + secondsOnly + millis;
            }

            return seconds;
        },
        updateLyrics(currentTime) {
            // 更新当前歌词行
            let currentLineIndex = 0;
            while (
                currentLineIndex < this.lyricList.length - 1 &&
                this.convertToSeconds(this.lyricList[currentLineIndex + 1].time) <= currentTime
            ) {
                currentLineIndex++;
                // console.log("+++");

            }
            // console.log(currentLineIndex);
            // console.log(this.lyricList[currentLineIndex].lyric);
            this.currentLyric = this.lyricList[currentLineIndex].lyric;

            this.currentLineIndex = currentLineIndex;
            // 滚动歌词容器以确保当前行可见
            const lineElement = this.$refs.lyricsContainer.children[currentLineIndex];
            if (lineElement) {
                // console.log("move");

                const containerTop = this.$refs.lyricsContainer.scrollTop;
                const lineTop = lineElement.offsetTop;
                const containerHeight = this.$refs.lyricsContainer.clientHeight;
                this.$refs.lyricsContainer.scrollTop = lineTop - containerHeight / 2;
                if (lineTop < containerTop || lineTop > containerTop + containerHeight) {
                    this.$refs.lyricsContainer.scrollTop = lineTop - containerHeight / 2;
                }
            }



        },
    }
}
</script>
<!-- -------------------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------------------- -->
<style scoped>
.el-header {
    /* background-color: rgba(240, 240, 240, 0.5); */
    color: #333;
    text-align: center;
    line-height: 50px;
}

.el-aside {
    background-color: rgb(232, 233, 237, 0.5);
    color: #6b6b6b;
    text-align: center;
    /* line-height: 200px; */
    /* height: 85vh; */
    box-shadow: 5px 0px 10px rgba(0, 0, 0, 0.3);
    border-radius: 20px;
}

.el-main {
    /* background-color: rgba(180, 176, 176, 0.158); */
    padding: 5px 15px;
    height: 91vh;

}

.menu-item:hover {
    background-color: rgba(231, 230, 230, 0.734);
    border-radius: 10px;
}

.tag {
    position: absolute;
    bottom: 100px;
    width: 30px;
    height: 30px;
    margin-left: 100px;
    background-color: rgba(238, 240, 244, 0.8);
    backdrop-filter: blur(10px);
    border-radius: 10px 10px 0px 0px;
    box-shadow: 5px 0px 10px rgba(0, 0, 0, 0.3);
    z-index: 97;
}

.footer {

    height: 100px;
    width: 100%;
    background-color: rgba(238, 240, 244, 0.8);
    box-shadow: 5px 0px 10px rgba(0, 0, 0, 0.3);
    border-radius: 20px;
    /* position: absolute;
    bottom: 0px; */
    z-index: 100;
    /* filter: blur(1px); */
    backdrop-filter: blur(10px);
}

.songList {
    height: 100%;
    width: 350px;
    background-color: rgba(238, 240, 244, 0.8);
    box-shadow: 5px 0px 10px rgba(0, 0, 0, 0.3);
    border-radius: 20px;
    position: absolute;
    /*right: 0px; */
    top: 0px;
    z-index: 99;
    backdrop-filter: blur(10px);
}

.songBox {
    height: calc(100% - 100px);
    width: 100%;
    background-color: rgba(238, 240, 244, 0.8);
    /* background-color: red; */
    box-shadow: 5px 0px 10px rgba(0, 0, 0, 0.3);
    border-radius: 20px;
    /* position: absolute; */
    /* bottom:-calc(100% - 100px); */
    /* bottom:100px; */
    z-index: 98;
    /* filter: blur(1px); */
    backdrop-filter: blur(10px);
}

.clear {
    /* width: 80px; */
    float: right;
    height: 30px;
    padding: 0 10px;
    line-height: 30px;
    margin-right: 10px;
}

.clear:hover {
    background-color: rgb(206, 206, 206);
    border-radius: 10px;
}

.music-item:hover {
    background-color: rgb(206, 206, 206);
    border-radius: 10px;
}

.music-name:hover {
    /* background-color: rgb(227, 225, 225); */
    color: #d392f8;
    /* border-radius: 10px; */
}

/* @keyframes scroll-text {
    0% {
        transform: translateX(0);
    }

    50% {
        transform: translateX(-50%);
    }

    100% {
        transform: translateX(0);
    }
}

.music-name {
    display: inline-block;
    white-space: nowrap;
    overflow: hidden;
    border: 1px solid #000;
    padding: 5px;
    position: relative;
}

.music-name::after {
    content: attr(data-text);
    position: absolute;
    white-space: nowrap;
    overflow: hidden;
    width: 100%;
    animation: scroll-text 10s linear infinite;
} */

.singer-name:hover {
    /* background-color: rgb(227, 225, 225); */
    color: #d392f8;
    /* border-radius: 10px; */
}

.play-icon:hover,
.last-icon:hover,
.next-icon:hover,
.order-icon:hover,
.sound-icon:hover,
.song-list-icon:hover,
.play-btn:hover {
    background-color: rgb(206, 206, 206);
    border-radius: 10px;
}

.detail-icon:hover {
    background-color: rgb(176, 176, 176);
    border-radius: 10px;
}

.el-popover {
    backdrop-filter: blur(10px);
}

.lyricDiv :hover {
    background-color: rgba(231, 230, 230, 0.734);
    border-radius: 10px;
}

.lyric-list {
    scrollbar-width: none;
    /* 隐藏滚动条 */
    -ms-overflow-style: none;
    /* 隐藏 IE 和 Edge 的滚动条 */
    overflow: -moz-scrollbars-none;
    /* 隐藏 Firefox 的滚动条 */
}
</style>